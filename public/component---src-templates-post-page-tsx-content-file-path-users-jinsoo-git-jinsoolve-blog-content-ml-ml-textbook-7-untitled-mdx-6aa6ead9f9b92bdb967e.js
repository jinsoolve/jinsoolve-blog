"use strict";(self.webpackChunkjinsoolve_blog=self.webpackChunkjinsoolve_blog||[]).push([[9798],{55991:function(e,t,a){a.r(t),a.d(t,{Head:function(){return z},default:function(){return P}});var n=a(28453),l=a(96540);function r(e){const t=Object.assign({p:"p",h1:"h1",a:"a",span:"span",img:"img",br:"br",pre:"pre",code:"code",h2:"h2",strong:"strong",math:"math",semantics:"semantics",mrow:"mrow",msup:"msup",mi:"mi",mn:"mn",annotation:"annotation",blockquote:"blockquote",ul:"ul",li:"li",h3:"h3",mfrac:"mfrac",mtext:"mtext",mo:"mo",div:"div"},(0,n.RP)(),e.components);return l.createElement(l.Fragment,null,l.createElement(t.p,null,"해당 내용은 머신러닝 교과서 with 파이썬, 사이킷런, 텐서플로의 장 내용을 기반으로 작성되었다."),"\n",l.createElement(t.h1,{id:"my-heading-1"},"6.1 파이프라인",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-1"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.img,{src:"https://i.imgur.com/z8WhuVW.png",alt:""}),"\n",l.createElement(t.p,null,"우리는 모델을 훈련시킬 때 데이터를 전처리한 후에 학습시킨다. 그럼 테스트 데이터셋이나 검증 데이터셋을 모델에 넣을 때도 같은 전처리 과정을 거쳐야 한다.",l.createElement(t.br),"\n","매번 같은 과정을 한 번에 표현할 수 있도록 도와주는 것이 파이프라인이다. 예시로 설명하겠다."),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-py"},"from sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.pipeline import make_pipeline\n\npipe_lr = make_pipeline(StandardScaler(),\n                        PCA(n_components=2),\n                        LogisticRegression(random_state=1))\n\npipe_lr.fit(X_train, y_train)\ny_pred = pipe_lr.predict(X_test)\nprint('테스트 정확도: %.3f' % pipe_lr.score(X_test, y_test))\n")),"\n",l.createElement(t.p,null,"위 코드는 정규화 -> PCA 차원 축소 -> 로지스틱회귀 순으로 전처리 및 모델링 하였다.",l.createElement(t.br),"\n","이를 파이프라인을 이용해 test 데이터셋에 동일하게 적용시켜 예측값을 반환하는 코드다. 매우 편리하게 사용할 수 있다."),"\n",l.createElement(t.h1,{id:"my-heading-2"},"6.2 K-Fold 교차 검증을 사용한 모델 성능 평가",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-2"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"적절한 편향-분산 트레이드 오프를 찾고 하이퍼 파라미터 튜닝을 통해서 적절한 모델을 선택하려면 해당 모델의 성능이 어떠한지를 평가해야 한다.",l.createElement(t.br),"\n","이때 테스트 데이터셋으로 평가 및 모델 조정 과정을 여러번 하게 되면 테스트 데이터셋도 사실상 훈련 데이터처럼 학습되고 과대적합될 수 있다. 때문에 훈련 데이터 안에서 검증 데이터를 따로 뗴어내어 해당 검증 데이터만으로 모델을 조정하고 한 번도 사용하지 않은 테스트 데이터셋으로 모델이 일반화가 잘 되었는지 확인해야 건강한(?) 모델링이라 할 수 있다."),"\n",l.createElement(t.p,null,"즉, 검증 데이터로 모델이 더 좋은 결과값을 얻도록 조정하고 깨끗한(?) 테스트 데이터로 모델의 일반화 능력을 확인하는 것이다.",l.createElement(t.br),"\n","그럼 이제 검증 과정에 대해서 자세히 알아보자."),"\n",l.createElement(t.h2,{id:"my-heading-3"},"6.2.1 홀드아웃",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-3"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"전통적이고 널리 알려져 있는 홀드아웃은 단순하게 훈련데이터에서 일부를 뗴어내고 이를 검증 데이터로 사용하는 것이다.",l.createElement(t.br),"\n","그러나 이 방법은 검증 데이터를 추출하는 경우마다 점수가 달라진다는 단점이 있다.",l.createElement(t.br),"\n","이를 해결하기 위해 훈련 데이터를 k개로 나눠서 k번의 홀드아웃을 하는 방식이 있는데 이를 ",l.createElement(t.strong,null,"k-fold 교차 검증"),"이라 한다."),"\n",l.createElement(t.h2,{id:"my-heading-4"},"6.2.2 K-Fold 교차 검증",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-4"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"k-fold는 k개로 나눠서 k번 진행한 홀드아웃에 대한 평균값을 반환하기 때문에 추출하는 케이스에 따라 값이 달라지는 정도가 훨씬 덜 하다는 정도가 있다.",l.createElement(t.br),"\n","또한 데이터를 k개로 나눌 때 중복을 허용하지 않고 샘플링하기 때문에 k번 홀드아웃한다고 해서 하나의 데이터를 여러 번 검증에 사용하지 않는다. (여러 번 사용하면 분산이 커지고 편향이 낮아짐. 즉, 과대적합될 수 있다.)"),"\n",l.createElement(t.p,null,"가장 기본적이고 많이 사용되는 k값은 10으로 대체적으로 좋은 성능을 보인다.",l.createElement(t.br),"\n","데이터가 너무 작다면 k를 증가시키는 것이 좋지만 과도하게 하면 과대적합(분산이 카지고, 편향이 작아짐)이 될 수 있으므로 주의해야 한다.",l.createElement(t.br),"\n","반면에 대규모 데이터인 경우 k값이 5정도만 돼도 충분하다."),"\n",l.createElement(t.p,null,"참고로 k-fold를 통해서 데이터 검증을 마치고 모델 조정(= 모델 선택)을 마쳤다면 검증 데이터를 다시 훈련 데이터에 합쳐서 이 전체 훈련 데이터로 모델을 다시 훈련시키는 것이 좋다. 훈련 샘플이 많을 수록 모델 성능이 더 안정화되고 정확해지기 때문이다."),"\n",l.createElement(t.h2,{id:"my-heading-5"},"6.2.3 Stratified K-Fold",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-5"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"기존 K-Fold는 target 데이터인 클래스의 비율이 균일하지 않을 때 편향-분산 트레이드 오프가 안 좋아지는데, 이를 계층화 k-fold로 어느 정도 해결할 수 있다.",l.createElement(t.br),"\n","stratified k-fold는 데이터를 k개로 나눌 때 클래스 비율이 전체 훈련 데이터의 비율과 최대한 동일하게 나눈다.",l.createElement(t.br),"\n","코드는 다음과 같다."),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-py"},"import numpy as np\nfrom sklearn.model_selection import StratifiedKFold\n\nkfold = StratifiedKFold(n_splits=10).split(X_train, y_train)\n\nscores = []\nfor k, (train, test) in enumerate(kfold):\n    pipe_lr.fit(X_train[train], y_train[train])\n    score = pipe_lr.score(X_train[test], y_train[test])\n    scores.append(score)\n    print('폴드: %2d, 클래스 분포: %s, 정확도: %.3f' % (k+1,\n          np.bincount(y_train[train]), score))\n    \n")),"\n",l.createElement(t.p,null,"k-fold의 점수를 알려면 stratified k-fold를 사용한 후에 각 폴드에 대한 점수를 파이프라인을 이용하여 계산 후에 저장해야 한다. 이를 사이킷런에서 만든 함수가 있는데 cross_val_score이다."),"\n",l.createElement(t.h2,{id:"my-heading-6"},"6.2.4 cross_val_score",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-6"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"사이킷런에 cross_val_score는 stratified k-fold를 해서 검증 데이터셋을 준비한 후에 이에 대한 점수값을 출력해주는 함수다."),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-py"},"from sklearn.model_selection import cross_val_score\n\n# estimator에는 우리가 사용한 파이프라인을 넣어준다. \n# cv에는 몇 개의 폴드를 나눌 지를 정한다.\nscores = cross_val_score(estimator=pipe_lr,\n                         X=X_train,\n                         y=y_train,\n                         cv=10,\n                         n_jobs=1)\nprint('CV 정확도 점수: %s' % scores)\nprint('CV 정확도: %.3f +/- %.3f' % (np.mean(scores), np.std(scores)))\n")),"\n",l.createElement(t.p,null,"cross_val_score의 기본 지표는 회귀: ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msup,null,l.createElement(t.mi,null,"R"),l.createElement(t.mn,null,"2"))),l.createElement(t.annotation,{encoding:"application/x-tex"},"R^2")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.8141em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"}},"R"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.8141em"}},l.createElement(t.span,{style:{top:"-3.063em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},"2")))))))))))),", 분류: 정확도 이다. scoring 파라미터를 이용해서 이를 변경할 수 있다."),"\n",l.createElement(t.h2,{id:"my-heading-7"},"6.2.5 cross_validate",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-7"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"대체로 cross_val_score를 통해서 교차검증을 해결할 수 있지만 좀 더 많은 정보가 필요한 경우에 cross_validate함수를 사용한다. 모델 훈련 및 테스트 시간, 여러 성능 메트릭, 원하는 작업(예: 예측 결과 저장)을 수행할 수 있다."),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-py"},"from sklearn.model_selection import cross_validate\n\nscores = cross_validate(estimator=pipe_lr, \n                        X=X_train, \n                        y=y_train, \n                        scoring=['accuracy'], \n                        cv=10, \n                        n_jobs=-1)\nprint('CV 정확도 점수: %s' % scores['test_accuracy'])\nprint('CV 정확도: %.3f +/- %.3f' % (np.mean(scores['test_accuracy']), \n                                 np.std(scores['test_accuracy'])))\n")),"\n",l.createElement(t.h2,{id:"my-heading-8"},"6.2.6 cross_val_predict",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-8"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"cross_val_score가 예측값에 따른 점수를 반환했다면,",l.createElement(t.br),"\n","cross_val_predict는 바로 그 예측값을 반환한다."),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-py"},"from sklearn.model_selection import cross_val_predict\n\n# method='predict_proba': 예측값을 얼마의 확률로 결과를 얻었는지 알게 된다.\npreds = cross_val_predict(estimator=pipe_lr,\n                          X=X_train, \n                          y=y_train,\n                          cv=10, \n                          method='predict_proba', \n                          n_jobs=-1)\npreds[:10]\n")),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,l.createElement("sub",null,"method='predict_proba' 없을 때"),l.createElement(t.br),"\n","array([0, 0, 0, 0, 0, 0, 0, 1, 1, 1])"),"\n"),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,l.createElement("sub",null,"method='predict_proba' 있을 떄"),l.createElement(t.br),"\n","array([[9.93982352e-01, 6.01764759e-03],",l.createElement(t.br),"\n","[7.64328337e-01, 2.35671663e-01],",l.createElement(t.br),"\n","[9.72683946e-01, 2.73160539e-02],",l.createElement(t.br),"\n","[8.41658121e-01, 1.58341879e-01],",l.createElement(t.br),"\n","[9.97144940e-01, 2.85506043e-03],",l.createElement(t.br),"\n","[9.99803660e-01, 1.96339882e-04],",l.createElement(t.br),"\n","[9.99324159e-01, 6.75840609e-04],",l.createElement(t.br),"\n","[2.12145074e-06, 9.99997879e-01],",l.createElement(t.br),"\n","[1.28668437e-01, 8.71331563e-01],",l.createElement(t.br),"\n","[7.76260670e-04, 9.99223739e-01]])"),"\n"),"\n",l.createElement(t.h1,{id:"my-heading-9"},"6.3 학습곡선과 검증곡선을 사용한 알고리즘 디버깅",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-9"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"학습곡선과 검증곡선을 그래프로 그려서 모델이 편향과 분산은 어떠한지, 과소적합인지, 과대적합인지를 해석할 수 있다.",l.createElement(t.br),"\n","물론 데이터 자체 수를 늘리는 것이 해결할 때도 많지만 이는 현실적으로 어렵고,",l.createElement(t.br),"\n","데이터에 노이즈가 많거나 모델이 이미 최적화된 경우 데이터양을 늘리는 것으로는 해결이 어렵다.",l.createElement(t.br),"\n","이때 학습곡선과 검증곡선을 분석해 이를 해결해 볼 수 있다."),"\n",l.createElement(t.h2,{id:"my-heading-10"},"6.3.1 학습곡선으로 편향과 분산 문제 분석",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-10"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.img,{src:"https://velog.velcdn.com/images/jinsoolve/post/a6389860-b464-4d4e-96fb-237c30088045/image.png",alt:""}),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"기대 정확도와 많이 떨어져 있을 수록 편향이 크다."),"\n",l.createElement(t.li,null,"학습 곡선과 검증 곡선 사이의 간격이 크다 = 분산이 크다."),"\n"),"\n",l.createElement(t.p,null,"마지막 그림처럼 기대 정확도에 가까우면서 학습곡선과 검증곡선 사이의 간격이 좁을 때가 좋은 편향과 분산을 가질 때다."),"\n",l.createElement(t.p,null,"이처럼 ",l.createElement(t.strong,null,"학습데이터의 크기에 따른 학습데이터와 검증데이터의 성능을 그린 그래프를 학습곡선"),"이라 한다."),"\n",l.createElement(t.h3,{id:"my-heading-11"},"6.3.1.1 그래프 그리기",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-11"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"훈련 데이터셋의 크기에 학습곡선을 그려 보자."),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-py"},"import matplotlib.pyplot as plt\nfrom sklearn.model_selection import learning_curve\n\n\npipe_lr = make_pipeline(StandardScaler(),\n                        LogisticRegression(penalty='l2', random_state=1,\n                                           max_iter=10000))\n\ntrain_sizes, train_scores, test_scores =\\\n                learning_curve(estimator=pipe_lr,\n                               X=X_train,\n                               y=y_train,\n                               train_sizes=np.linspace(0.1, 1.0, 10),\n                               cv=10,\n                               n_jobs=1)\n\ntrain_mean = np.mean(train_scores, axis=1)\ntrain_std = np.std(train_scores, axis=1)\ntest_mean = np.mean(test_scores, axis=1)\ntest_std = np.std(test_scores, axis=1)\n\nplt.plot(train_sizes, train_mean,\n         color='blue', marker='o',\n         markersize=5, label='Training accuracy')\n\nplt.fill_between(train_sizes,\n                 train_mean + train_std,\n                 train_mean - train_std,\n                 alpha=0.15, color='blue')\n\nplt.plot(train_sizes, test_mean,\n         color='green', linestyle='--',\n         marker='s', markersize=5,\n         label='Validation accuracy') \n\nplt.fill_between(train_sizes,\n                 test_mean + test_std,\n                 test_mean - test_std,\n                 alpha=0.15, color='green')\n\nplt.grid()\nplt.xlabel('Number of training examples')\nplt.ylabel('Accuracy')\nplt.legend(loc='lower right')\nplt.ylim([0.8, 1.03])\nplt.tight_layout()\n# plt.savefig('images/06_05.png', dpi=300)\nplt.show()\n")),"\n",l.createElement(t.img,{src:"https://velog.velcdn.com/images/jinsoolve/post/a6a8b8ee-b1be-41fb-9a3b-e385ad38958c/image.png",alt:""}),"\n",l.createElement(t.h3,{id:"my-heading-12"},"6.3.1.2 그래프 해석",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-12"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"훈련데이터의 크기가 250 이상일 때 좋은 편향, 분산을 갖게 되는 것으로 보인다."),"\n",l.createElement(t.h2,{id:"my-heading-13"},"6.3.2 검증곡선으로 과대적합, 과소적합 조사",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-13"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,l.createElement(t.strong,null,"하이퍼 파라미터에 따른 훈련 데이터와 검증 데어티의 성능을 그린 그래프를 검증곡선"),"이라 한다."),"\n",l.createElement(t.h3,{id:"my-heading-14"},"6.3.2.1 그래프 그리기",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-14"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"이번에는 로지스틱 회귀의 파라미터 C의 값에 따른 검증 곡선을 그려보자."),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"language-py"},"from sklearn.model_selection import validation_curve\n\n\nparam_range = [0.001, 0.01, 0.1, 1.0, 10.0, 100.0]\n\n# param_name='logisticregression__C': 로지스틱 회귀의 파라미터 C를 x축으로 사용한다.\ntrain_scores, test_scores = validation_curve(\n                estimator=pipe_lr, \n                X=X_train, \n                y=y_train, \n                param_name='logisticregression__C', \n                param_range=param_range,\n                cv=10)\n\ntrain_mean = np.mean(train_scores, axis=1)\ntrain_std = np.std(train_scores, axis=1)\ntest_mean = np.mean(test_scores, axis=1)\ntest_std = np.std(test_scores, axis=1)\n\nplt.plot(param_range, train_mean, \n         color='blue', marker='o', \n         markersize=5, label='Training accuracy')\n\nplt.fill_between(param_range, train_mean + train_std,\n                 train_mean - train_std, alpha=0.15,\n                 color='blue')\n\nplt.plot(param_range, test_mean, \n         color='green', linestyle='--', \n         marker='s', markersize=5, \n         label='Validation accuracy')\n\nplt.fill_between(param_range, \n                 test_mean + test_std,\n                 test_mean - test_std, \n                 alpha=0.15, color='green')\n\nplt.grid()\nplt.xscale('log')\nplt.legend(loc='lower right')\nplt.xlabel('Parameter C')\nplt.ylabel('Accuracy')\nplt.ylim([0.8, 1.0])\nplt.tight_layout()\n# plt.savefig('images/06_06.png', dpi=300)\nplt.show()\n")),"\n",l.createElement(t.img,{src:"https://velog.velcdn.com/images/jinsoolve/post/c2df2e33-f940-4785-8fa1-ede4cc544673/image.png",alt:""}),"\n",l.createElement(t.h3,{id:"my-heading-15"},"6.3.2.2 그래프 해석",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-15"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"C가 너무 낮다 -> 규제가 강하다 -> 모델 단순화 -> 과소적합 이 된다.",l.createElement(t.br),"\n","그래프를 보면 C가 낮을 때 훈련데이터와 검증데이터의 정확도가 얼마 차이 나고 이는 모델의 일반화 능력이 좋다는 것을 의미하지만 정확도 자체가 낮다. 따라서 과소적합이라고 해석할 수 있다."),"\n",l.createElement(t.li,null,"C가 너무 크다 -> 규제가 약하다 -> 모델 복잡도 증가 -> 과대적합 이 된다.",l.createElement(t.br),"\n","그래프를 보면 C가 클 때 정확도 자체는 높아지지만 훈련데이터와 검증데이터의 정확도의 차이가 커진다. 이는 모델의 일반화 능력이 좋지 않다는 것을 의미하고 과대적합이라고 해석할 수 있다."),"\n"),"\n",l.createElement(t.h1,{id:"my-heading-16"},"6.4 그리드 서치를 사용한 머신러닝 모델 세부 튜닝",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-16"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"하이퍼 파라미터를 튜닝하는 데 사용하는 gridsearch가 있다."),"\n",l.createElement(t.h2,{id:"my-heading-17"},"6.4.1 그리드 서치를 사용한 하이퍼파라미터 튜닝",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-17"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,l.createElement(t.strong,null,"GridSearchCV"),"함수를 이용하여 교차검증 폴드의 평균 점수를 이용하여 하이퍼파라미터를 튜닝시킨다."),"\n",l.createElement(t.p,null,"그러나 GridSearchCV는 너무 많은 계산 비용이 드는데 이를 ",l.createElement(t.strong,null,"RandomizedSearchCV"),"를 이용해 어느 정도 해결할 수 있다. 특히 매개변수 탐색 범위가 넓거나 연속적인 매개변수를 탐색해야 할 때 효과적이다."),"\n",l.createElement(t.p,null,l.createElement(t.strong,null,"HalvingGridSearchCV"),"는 몇 개의 샘플에 대해서 교차검증을 하고 좋은 결과 나온 후보만을 골라서 다시 교차검증을 하는 방식이다. GridSearchCV보다는 결과가 아주 미세하게 안 좋을 수 있지만 계산 비용이 훨씬 저렴하다."),"\n",l.createElement(t.h2,{id:"my-heading-18"},"6.4.2. 중첩 교차 검증을 사용한 알고리즘 선택",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-18"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"일반 교차 검증이 훈련 셋과 테스트 셋으로 나누어 검증한 것이라면,",l.createElement(t.br),"\n","중첩 교차 검증은 나누어진 훈련셋과 테스트셋들에 대해서 훈련셋을 다시 검증폴드와 훈련폴드로 나누어 교차검증을 진행한다.",l.createElement(t.br),"\n",l.createElement(t.img,{src:"https://velog.velcdn.com/images/jinsoolve/post/7b81bf22-5390-4f08-96ca-2ad69322f331/image.png",alt:""}),l.createElement(t.br),"\n","중첩 교차 검증이 당연히 일반 교차 검증보다 뛰어날 수 밖에 없다."),"\n",l.createElement(t.h1,{id:"my-heading-19"},"6.5 여러 가지 성능 평가 지표",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-19"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"주로 'accuracy' 정확도 지표를 사용하여 모델을 평가하는 것이 모델 성능에 도움이 된다.",l.createElement(t.br),"\n","주어진 모델이 적합한지 측정할 수 있는 다른 성능 지표도 여럿 있다. 정밀도(precision), 재현율(recall), F1-점수이  있다."),"\n",l.createElement(t.h2,{id:"my-heading-20"},"6.5.1 오차 행렬",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-20"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,l.createElement(t.img,{src:"https://velog.velcdn.com/images/jinsoolve/post/d028993e-89b1-4898-8438-861cc7bdbaff/image.png",alt:""}),l.createElement(t.br),"\n","오차행렬은 예측값과 실제값에 대한 비교 행렬이다.",l.createElement(t.br),"\n","아래와 같은 코드로 사용할 수 있다.",l.createElement(t.br),"\n",l.createElement(t.img,{src:"https://velog.velcdn.com/images/jinsoolve/post/cbe78099-bd1c-4f3b-af3b-f3ceda524de7/image.png",alt:""})),"\n",l.createElement(t.h2,{id:"my-heading-21"},"6.5.2 분류 모델의 정밀도와 재현율 최적화",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-21"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"정밀도(PRE)는 모델이 Positive라고 예측한 값 중 실제 Positive인 비율을 뜻한다.","\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mfrac,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"T"),l.createElement(t.mi,null,"P")),l.createElement(t.mrow,null,l.createElement(t.mtext,null,"예측"),l.createElement(t.mi,null,"P")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"\\frac{TP}{예측P}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1.2173em",verticalAlign:"-0.345em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mopen nulldelimiter"}),l.createElement(t.span,{className:"mfrac"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.8723em"}},l.createElement(t.span,{style:{top:"-2.655em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord hangul_fallback mtight"},"예측"),l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"P")))),l.createElement(t.span,{style:{top:"-3.23em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})),l.createElement(t.span,{style:{top:"-3.394em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"TP"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.345em"}},l.createElement(t.span))))),l.createElement(t.span,{className:"mclose nulldelimiter"}))))))," = ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mfrac,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"T"),l.createElement(t.mi,null,"P")),l.createElement(t.mrow,null,l.createElement(t.mi,null,"T"),l.createElement(t.mi,null,"P"),l.createElement(t.mo,null,"+"),l.createElement(t.mi,null,"F"),l.createElement(t.mi,null,"P")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"\\frac{TP}{TP+FP}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1.2757em",verticalAlign:"-0.4033em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mopen nulldelimiter"}),l.createElement(t.span,{className:"mfrac"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.8723em"}},l.createElement(t.span,{style:{top:"-2.655em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"TP"),l.createElement(t.span,{className:"mbin mtight"},"+"),l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"FP")))),l.createElement(t.span,{style:{top:"-3.23em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})),l.createElement(t.span,{style:{top:"-3.394em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"TP"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.4033em"}},l.createElement(t.span))))),l.createElement(t.span,{className:"mclose nulldelimiter"}))))))),"\n"),"\n"),"\n",l.createElement(t.li,null,"재현율(REC)는 실제 Positive인 경우에 모델이 Positive라고 예측한 비율을 뜻한다.","\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mfrac,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"T"),l.createElement(t.mi,null,"P")),l.createElement(t.mrow,null,l.createElement(t.mtext,null,"실제"),l.createElement(t.mi,null,"P")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"\\frac{TP}{실제P}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1.2173em",verticalAlign:"-0.345em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mopen nulldelimiter"}),l.createElement(t.span,{className:"mfrac"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.8723em"}},l.createElement(t.span,{style:{top:"-2.655em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord hangul_fallback mtight"},"실제"),l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"P")))),l.createElement(t.span,{style:{top:"-3.23em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})),l.createElement(t.span,{style:{top:"-3.394em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"TP"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.345em"}},l.createElement(t.span))))),l.createElement(t.span,{className:"mclose nulldelimiter"}))))))," = ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mfrac,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"T"),l.createElement(t.mi,null,"P")),l.createElement(t.mrow,null,l.createElement(t.mi,null,"F"),l.createElement(t.mi,null,"N"),l.createElement(t.mo,null,"+"),l.createElement(t.mi,null,"T"),l.createElement(t.mi,null,"P")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"\\frac{TP}{FN+TP}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1.2757em",verticalAlign:"-0.4033em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mopen nulldelimiter"}),l.createElement(t.span,{className:"mfrac"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.8723em"}},l.createElement(t.span,{style:{top:"-2.655em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"FN"),l.createElement(t.span,{className:"mbin mtight"},"+"),l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"TP")))),l.createElement(t.span,{style:{top:"-3.23em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})),l.createElement(t.span,{style:{top:"-3.394em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"TP"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.4033em"}},l.createElement(t.span))))),l.createElement(t.span,{className:"mclose nulldelimiter"}))))))),"\n"),"\n"),"\n"),"\n",l.createElement(t.p,null,"악성 종양 감지 문제에서 악성 종양:1, 양성 종양:0 이라고 하자.",l.createElement(t.br),"\n","정밀도를 최적화시키면 건강한 환자에게 악성 종양을 감지하는 일이 줄어들고,",l.createElement(t.br),"\n","재현율을 최적화시키면 아픈 환자에게 건강하다고 하는 일이 줄어든다."),"\n",l.createElement(t.p,null,"이러한 PRE와 REC 최적화 균형을 맞추기 위해 이를 조합한 F1-score 지표를 자주 사용한다."),"\n",l.createElement(t.div,{className:"math math-display"},l.createElement(t.span,{className:"katex-display"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"F"),l.createElement(t.mn,null,"1"),l.createElement(t.mo,null,"="),l.createElement(t.mn,null,"2"),l.createElement(t.mfrac,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"P"),l.createElement(t.mi,null,"R"),l.createElement(t.mi,null,"E"),l.createElement(t.mo,null,"×"),l.createElement(t.mi,null,"R"),l.createElement(t.mi,null,"E"),l.createElement(t.mi,null,"C")),l.createElement(t.mrow,null,l.createElement(t.mi,null,"P"),l.createElement(t.mi,null,"R"),l.createElement(t.mi,null,"E"),l.createElement(t.mo,null,"+"),l.createElement(t.mi,null,"R"),l.createElement(t.mi,null,"E"),l.createElement(t.mi,null,"C")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"F1 = 2\\frac{PRE \\times REC}{PRE + REC}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.6833em"}}),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"}},"F"),l.createElement(t.span,{className:"mord"},"1"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}}),l.createElement(t.span,{className:"mrel"},"="),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}})),l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"2.1297em",verticalAlign:"-0.7693em"}}),l.createElement(t.span,{className:"mord"},"2"),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mopen nulldelimiter"}),l.createElement(t.span,{className:"mfrac"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"1.3603em"}},l.createElement(t.span,{style:{top:"-2.314em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"}},"PRE"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2222em"}}),l.createElement(t.span,{className:"mbin"},"+"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2222em"}}),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"}},"REC"))),l.createElement(t.span,{style:{top:"-3.23em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})),l.createElement(t.span,{style:{top:"-3.677em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"}},"PRE"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2222em"}}),l.createElement(t.span,{className:"mbin"},"×"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2222em"}}),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"}},"REC")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.7693em"}},l.createElement(t.span))))),l.createElement(t.span,{className:"mclose nulldelimiter"}))))))),"\n",l.createElement(t.img,{src:"https://velog.velcdn.com/images/jinsoolve/post/c24b94f0-1262-4d74-92fb-7d4d873f995b/image.png",alt:""}),"\n",l.createElement(t.p,null,"아래와 같이 make_scorer()를 이용해 scorer 변수를 만들 수 있다.",l.createElement(t.br),"\n","pos_label=0: 레이블이 0이 양성 클래스가 되도록 바꿔준다.",l.createElement(t.br),"\n",l.createElement(t.img,{src:"https://velog.velcdn.com/images/jinsoolve/post/e29a11df-c762-4103-a54e-9a3e12d05a2d/image.png",alt:""})),"\n",l.createElement(t.h2,{id:"my-heading-22"},"6.5.3 ROC 곡선 그리기",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-22"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,l.createElement(t.img,{src:"https://velog.velcdn.com/images/jinsoolve/post/23a67ae0-e71c-461e-bb0c-025070af0cc0/image.png",alt:""}),l.createElement(t.br),"\n","ROC 곡선은 FPR, TPR을 축으로 해서 그리는 그래프이다."),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"FPR은 거짓 양성 비율 즉, ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mfrac,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"F"),l.createElement(t.mi,null,"P")),l.createElement(t.mrow,null,l.createElement(t.mtext,null,"실제"),l.createElement(t.mi,null,"N")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"\\frac{FP}{실제 N}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1.2173em",verticalAlign:"-0.345em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mopen nulldelimiter"}),l.createElement(t.span,{className:"mfrac"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.8723em"}},l.createElement(t.span,{style:{top:"-2.655em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord hangul_fallback mtight"},"실제"),l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N")))),l.createElement(t.span,{style:{top:"-3.23em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})),l.createElement(t.span,{style:{top:"-3.394em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"FP"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.345em"}},l.createElement(t.span))))),l.createElement(t.span,{className:"mclose nulldelimiter"}))))))),"\n",l.createElement(t.li,null,"TPR은 진짜 양성 비율 즉, ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mfrac,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"T"),l.createElement(t.mi,null,"P")),l.createElement(t.mrow,null,l.createElement(t.mtext,null,"실제"),l.createElement(t.mi,null,"P")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"\\frac{TP}{실제 P}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1.2173em",verticalAlign:"-0.345em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mopen nulldelimiter"}),l.createElement(t.span,{className:"mfrac"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.8723em"}},l.createElement(t.span,{style:{top:"-2.655em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord hangul_fallback mtight"},"실제"),l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"P")))),l.createElement(t.span,{style:{top:"-3.23em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})),l.createElement(t.span,{style:{top:"-3.394em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"TP"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.345em"}},l.createElement(t.span))))),l.createElement(t.span,{className:"mclose nulldelimiter"}))))))),"\n"),"\n",l.createElement(t.p,null,"auc(Area Under the ROC Curve)는 ROC curve의 밑면적을 말한다. 해당 값이 높을수록 높은 정확도를 갖는다.",l.createElement(t.br),"\n","roc_curve 함수를 사용하면 fpr, tpr를 얻을 수 있다. 이를 그래프를 그리는 사용하거나 auc함수에 넘겨줘서 roc_auc 점수를 얻을 수 있다.",l.createElement(t.br),"\n","",l.createElement(t.br),"\n","roc_auc_score 함수를 사용하면 바로 ROC-AUC 점수를 얻을 수 있다."),"\n",l.createElement(t.h2,{id:"my-heading-23"},"6.5.4 다중 분류의 성능 지표",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-23"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"이진 분류 말고 다중 클래스에 대한 분류를 할 때의 성능지표에 대해서 말하겠다."),"\n",l.createElement(t.p,null,"micro 평균은 기존의 PRE를 k개의 클래스에 대한 PRE로 만든 것이고 이는 각 샘플이나 예측에 동일한 가중치를 부여하고자 할 때 사용된다."),"\n",l.createElement(t.p,null,"macro 평균은 단순하게 클래스별 PRE의 평균값이다. 가중치가 적용된 macro 평균은 레이블마다 샘플 개수가 다른 불균형한 클래스를 다룰 때 유용하다."),"\n",l.createElement(t.h1,{id:"my-heading-24"},"6.6 불균형한 클래스 다루기",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-24"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"불균형한 클래스를 처리하지 않고 모델을 훈련시키면 학습 알고리즘 자체에 영향을 끼친다."),"\n",l.createElement(t.p,null,"이를 소수 클래스에서 발생한 예측 오류에 큰 벌칙을 부여하는 방식으로 해결해 볼 수 있다. 대부분의 분류기에 구현된 **class_weight='balanced'**로 설정해서 조정할 수 있다."),"\n",l.createElement(t.p,null,"혹은 소수클래스의 샘플을 늘리거나(",l.createElement(t.strong,null,"업샘플링"),") 다수클래스의 샘플을 줄이는(",l.createElement(t.strong,null,"다운샘플링"),") 방식을 사용하여 해결해 볼 수 있다.",l.createElement(t.br),"\n","다음은 다운샘플링에 대한 코드다. resample 함수를 사용한다.  업샘플링을 하려면 y_imb == 0과 y_imb == 1의 값을 뒤바꿔주면 된다."),"\n",l.createElement("sub",null,"또는 인공적인 훈련 샘플을 만들어 볼 수 있다. SMOTE(Synthetic Minority Over-sampling TEchinque)를 사용해 볼 수 있다. imbalanced-learn 파이썬 라이브러리에 구현되어 있다."),"\n",l.createElement(t.h1,{id:"my-heading-25"},"6.7 요약",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-25"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"모델 평가","\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"pipeline"),"\n",l.createElement(t.li,null,"k-fold"),"\n"),"\n"),"\n",l.createElement(t.li,null,"모델 세부 튜닝","\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"학습곡선, 검증곡선 -> 문제 분석"),"\n",l.createElement(t.li,null,"GridSearchCV"),"\n",l.createElement(t.li,null,"RandomizedSearchCV"),"\n",l.createElement(t.li,null,"성능지표 (오차행렬, 정밀도, 재현율, ROC 곡선 ..)"),"\n"),"\n"),"\n",l.createElement(t.li,null,"불균형 데이터 처리","\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"class_weight 매개변수"),"\n",l.createElement(t.li,null,"upsampling & downsampling"),"\n"),"\n"),"\n"))}var m=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,n.RP)(),e.components);return t?l.createElement(t,e,l.createElement(r,e)):r(e)},s=a(54183),c=a(63840),i=a(67234),o=a(74196),p=a(33738),E=a(59146),d=a(32532),h=a(12931),u=a(92072),g=a(13626),N=a(39315),v=a(59879),y=a(68743),b=a(780),f=a(82228),_=a(66505),x=a(47722),w=a(55135),k=a(73992),R=a(80795);const C=e=>{var t,a,n,r,m,d;let{children:R,data:C,pageContext:z}=e;const P=C.otherLocalePost.nodes.map((e=>{var t;return(null===(t=e.frontmatter)||void 0===t?void 0:t.locale)||"ko"})),{0:S,1:T}=(0,l.useState)(!1),I=(0,l.useRef)(null),A=(null===(t=C.post)||void 0===t||null===(a=t.frontmatter)||void 0===a?void 0:a.locale)||"ko",M=null===(n=C.post)||void 0===n||null===(r=n.frontmatter)||void 0===r?void 0:r.slug,L=(0,s.A)({base:!1,"1.75xl":!0}),{0:F,1:j}=((0,s.A)({base:"6",md:"8"}),(0,l.useState)(!1)),W=(0,l.useRef)(null),{0:O,1:X}=(0,l.useState)(300),{colorMode:V}=(0,c.G6)();return(0,l.useEffect)((()=>{const e=()=>{T(window.innerWidth<630)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,l.useEffect)((()=>{const e=e=>{(W.current&&!W.current.contains(e.target)||I.current&&!I.current.contains(e.target))&&j(!1)};return F&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[F]),(0,l.useEffect)((()=>{const e=e=>{if(!W.current)return;const t=W.current;if(t.contains(e.target)){const a=0===t.scrollTop,n=Math.ceil(t.scrollTop+t.clientHeight)>=t.scrollHeight;(a&&e.deltaY<0||n&&e.deltaY>0)&&e.preventDefault()}},t=e=>{if(!W.current)return;const t=W.current;if(t.contains(e.target)){const a=0===t.scrollTop,n=Math.ceil(t.scrollTop+t.clientHeight)>=t.scrollHeight;(a&&e.touches[0].clientY>0||n&&e.touches[0].clientY<0)&&e.preventDefault()}};return F&&(document.addEventListener("wheel",e,{passive:!1}),document.addEventListener("touchmove",t,{passive:!1})),()=>{document.removeEventListener("wheel",e),document.removeEventListener("touchmove",t)}}),[F]),l.createElement(_.A,{tableOfContents:L?null===(m=C.post)||void 0===m?void 0:m.myTableOfContents:void 0},l.createElement(i.s,{direction:"column",width:"100%"},l.createElement(f.A,{readingTime:z.readingTime.text,post:C.post}),!L&&(null===(d=C.post)||void 0===d?void 0:d.myTableOfContents)&&l.createElement(l.Fragment,null,l.createElement(N.P.div,{initial:{right:"0px"},animate:{right:"0px"},transition:{duration:.3},style:{position:"fixed",bottom:S?"40px":"70px",transform:"translateY(-50%)",zIndex:10}},l.createElement(o.K,{"aria-label":"Toggle TOC",borderRadius:"full",size:"lg",right:{base:"12px",sm:"15px",md:"30px"},onClick:()=>j(!F),variant:"ghost",_hover:{bg:"transparent",color:"blue.400"},_focus:{boxShadow:"none",bg:"transparent"},display:F?"none":"block",icon:l.createElement(i.s,{alignItems:"center",justifyContent:"center"},F?l.createElement(l.Fragment,null,l.createElement(h.v,{boxSize:"20px",ml:-1}),l.createElement(p.I,{as:v.hCN,boxSize:"24px",ml:-1})," "):l.createElement(l.Fragment,null,l.createElement(u.Y,{boxSize:"20px",ml:-1}),l.createElement(p.I,{as:v.hCN,boxSize:"24px",ml:-1})," "))})),l.createElement(N.P.div,{initial:{right:"-300px"},animate:{right:F?"0px":"-300px"},transition:{duration:.3},ref:W,style:{position:"fixed",top:0,height:"100vh",width:"300px",maxWidth:"80vw",zIndex:10,overflowY:"auto",overflowX:"hidden"}},l.createElement(E.a,{backgroundColor:"white",boxShadow:"md",position:"relative",height:"100%",width:"300px",_dark:{backgroundColor:"gray.800"}},l.createElement(o.K,{"aria-label":"Close TOC",icon:l.createElement(g.U,null),position:"absolute",top:"10px",right:"10px",onClick:()=>j(!1),size:"sm",backgroundColor:"transparent",color:"black",_dark:{color:"white"}}),l.createElement(E.a,{pt:"60px",pb:"20px",pl:"20px",width:"300px",backgroundColor:"white",_dark:{backgroundColor:"gray.800"}},l.createElement(k.A,{tableOfContents:C.post.myTableOfContents}))))),P.length>1&&l.createElement(b.A,{currentSlug:M,locales:P,currentLocale:A}),l.createElement(E.a,{marginTop:"40px",sx:{img:{borderRadius:"10px"}}},R),l.createElement(w.A,{relatedPosts:C.relatedPosts}),l.createElement(x.A,null),l.createElement(y.A,null)))},z=e=>{var t,a,n,r,m,s,c,i,o,p,E,h,u,g,N,v,y,b,f,_,x;let{data:w}=e;const k=(null===(t=w.post)||void 0===t||null===(a=t.frontmatter)||void 0===a?void 0:a.locale)||"ko",C="ko"===k?(null===(n=w.post)||void 0===n||null===(r=n.frontmatter)||void 0===r?void 0:r.title)+" - Jinsoolve 블로그":(null===(m=w.post)||void 0===m||null===(s=m.frontmatter)||void 0===s?void 0:s.title)+" - Jinsoolve Blog",z=null===(c=w.post)||void 0===c||null===(i=c.frontmatter)||void 0===i?void 0:i.description,P=null===(o=w.post)||void 0===o||null===(p=o.frontmatter)||void 0===p||null===(E=p.thumbnail)||void 0===E||null===(h=E.childImageSharp)||void 0===h?void 0:h.gatsbyImageData,S="ko"===k?"ko_KR":"en_US",T="ko"===k?"개발":"Development";return l.createElement(l.Fragment,null,l.createElement("title",null,C),l.createElement("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),l.createElement("meta",{property:"og:url",content:R.V2+"/posts/"+(null===(u=w.post)||void 0===u||null===(g=u.frontmatter)||void 0===g?void 0:g.slug)}),l.createElement("meta",{property:"og:type",content:"website"}),l.createElement("meta",{property:"og:site_name",content:C}),l.createElement("meta",{property:"og:title",content:C}),l.createElement("meta",{property:"og:description",content:z}),l.createElement("meta",{property:"og:image",content:(0,d.d)(P)}),l.createElement("meta",{property:"og:locale",content:S}),l.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),l.createElement("meta",{property:"twitter:domain",content:"jinsoolve.netlify.app"}),l.createElement("meta",{property:"twitter:url",content:R.V2+"/posts/"+(null===(N=w.post)||void 0===N||null===(v=N.frontmatter)||void 0===v?void 0:v.slug)}),l.createElement("meta",{name:"twitter:title",content:C}),l.createElement("meta",{name:"twitter:description",content:z}),l.createElement("meta",{name:"twitter:image",content:(0,d.d)(P)}),l.createElement("meta",{name:"twitter:label1",content:"Category"}),l.createElement("meta",{name:"twitter:data1",content:T+" | "+(null===(y=w.post)||void 0===y||null===(b=y.frontmatter)||void 0===b?void 0:b.categories[0])}),l.createElement("meta",{name:"article:published_time",content:(null===(f=w.post)||void 0===f||null===(_=f.frontmatter)||void 0===_||null===(x=_.createdAt)||void 0===x?void 0:x.replace(/[/]/g,"-"))+"T09:00:00.000Z"}))};function P(e){return l.createElement(C,e,l.createElement(m,e))}},780:function(e,t,a){var n=a(67234),l=a(21052),r=a(58693),m=a(96540);t.A=e=>{let{currentLocale:t,locales:a,currentSlug:s}=e;return m.createElement(n.s,{alignItems:"center",marginTop:10,gap:2},m.createElement(l.E,{fontSize:16,fontWeight:"800",color:"black.900"},"Locales:"),m.createElement(n.s,{overflow:"hidden",width:"100%",gap:2,fontSize:12},a.map((e=>{const a="ko"===e?"/posts/"+s:"/"+e+"/posts/"+s;return e===t?m.createElement(l.E,{key:e,fontSize:16,fontWeight:"600",textDecoration:"underline",color:"black.900"},e):m.createElement(r.Link,{key:e,to:a},m.createElement(l.E,{fontSize:16,color:"black.900"},e))}))))}},95841:function(e,t,a){var n=a(59146),l=a(67234),r=a(85353),m=a(21052),s=a(58693),c=a(32532),i=a(96540),o=a(63840),p=a(96540);t.A=e=>{let{createdAt:t,description:a,slug:E,thumbnail:d,title:h,updatedAt:u,excerpt:g}=e;const N=(0,i.useMemo)((()=>(new Date).getTime()-new Date(t).getTime()),[t]),v=(0,i.useMemo)((()=>Math.floor(N/864e5)<=10),[N]),y=(0,o.dU)("gray.50","#444548"),b=(0,o.dU)("blue.500","blue.400"),f=((0,o.dU)("0 4px 6px rgba(0, 0, 0, 0.3)","0 4px 6px rgba(255, 255, 255, 0.3)"),(0,i.useMemo)((()=>d?"380px":{base:"190px",sm_md:"380px"}),[d]));return p.createElement(s.Link,{to:"/posts/"+E},p.createElement(n.a,{as:"article",transition:"all 0.25s ease",position:"relative",borderRadius:"20px",overflow:"hidden",width:{base:"280px",sm_md:"290px"},minWidth:"205px",maxWidth:"85vw",minHeight:f,height:"100%",boxShadow:"xl",borderWidth:"2px",borderColor:y,_hover:{borderColor:b,boxShadow:"xl",cursor:"pointer"}},p.createElement(c.G,{objectFit:"cover",style:{maxHeight:"171px",height:"45%",width:"100%"},image:d,alt:E+" cover image"}),p.createElement(l.s,{flexDirection:"column",justifyContent:"space-between",height:d?"55%":"100%",padding:"20px"},p.createElement(n.a,null,p.createElement(r.D,{fontSize:"20px",fontWeight:"700",marginBottom:"8px"},h),p.createElement(m.E,{fontSize:"16px",color:"gray.600",noOfLines:2,marginBottom:"10px"},a||g)),p.createElement(l.s,{justifyContent:"space-between",alignItems:"flex-start",marginTop:"10px"},p.createElement(m.E,{fontSize:"14px",color:"gray.500"},u?u+" (updated)":t),p.createElement(n.a,{backgroundColor:"blue.400",color:"white",borderRadius:"12px",padding:"4px 8px",fontSize:"12px",fontWeight:"bold",visibility:v?"visible":"hidden"},"NEW POST")))))}},55135:function(e,t,a){var n=a(63840),l=a(59146),r=a(85353),m=a(32818),s=a(75828),c=a(9e4),i=a(33738),o=a(58693),p=a(12931),E=a(95841),d=a(96540);t.A=e=>{let{relatedPosts:t}=e;const a=null==t?void 0:t.nodes.length,h=null==t?void 0:t.nodes.slice(0,4),u=((0,n.dU)("white","black"),(0,n.dU)("gray.50","#444548")),g=(0,n.dU)("blue.500","blue.400");return d.createElement(l.a,{marginTop:"200px"},a?d.createElement(r.D,{as:"h2",fontSize:24},"관련 포스트가 ",a,"개 있어요."):d.createElement(m.o,{height:"100px",borderRadius:"8px",backgroundColor:"blue.50"},d.createElement("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M12 1.999c5.524 0 10.002 4.478 10.002 10.002 0 5.523-4.478 10.001-10.002 10.001-5.524 0-10.002-4.478-10.002-10.001C1.998 6.477 6.476 1.999 12 1.999Zm-.004 8.25a1 1 0 0 0-.992.885l-.007.116.003 5.502.007.117a1 1 0 0 0 1.987-.002L13 16.75l-.003-5.501-.007-.117a1 1 0 0 0-.994-.882ZM12 6.5a1.251 1.251 0 1 0 0 2.503A1.251 1.251 0 0 0 12 6.5Z",fill:"#3182ce"})),d.createElement(r.D,{as:"h2",color:"blue.500",fontSize:20},"관련 포스트가 없어요.")),d.createElement(s.x,{mt:"20px",templateColumns:{sm_md:"repeat(2, 1fr)",lg:"repeat(2, 1fr)"},gap:6,alignItems:"center",justifyContent:"center"},null==h?void 0:h.map((e=>{var t,a,n,l,r,m,s,i,o,p;return d.createElement(c.E,{as:"article",key:null==e||null===(t=e.frontmatter)||void 0===t?void 0:t.slug,display:"flex",alignItems:"center",justifyContent:"center"},d.createElement(E.A,{title:null===(a=e.frontmatter)||void 0===a?void 0:a.title,description:null===(n=e.frontmatter)||void 0===n?void 0:n.description,slug:null===(l=e.frontmatter)||void 0===l?void 0:l.slug,thumbnail:null===(r=e.frontmatter)||void 0===r||null===(m=r.thumbnail)||void 0===m||null===(s=m.childImageSharp)||void 0===s?void 0:s.gatsbyImageData,createdAt:null===(i=e.frontmatter)||void 0===i?void 0:i.createdAt,updatedAt:null===(o=e.frontmatter)||void 0===o?void 0:o.updatedAt,categories:null===(p=e.frontmatter)||void 0===p?void 0:p.categories,excerpt:e.excerpt}))}))),a>6&&d.createElement(m.o,{mt:"20px"},d.createElement(o.Link,{to:"/categories/"+t.nodes[0].frontmatter.categories[0]},d.createElement(l.a,{as:"button",mt:"20px",transition:"all 0.25s ease",padding:"10px 20px",borderRadius:"12px",fontWeight:"bold",boxShadow:"xl",borderWidth:"2px",borderColor:u,_hover:{borderColor:g,boxShadow:"xl",cursor:"pointer"},display:"flex",alignItems:"center"},"더 많은 관련 포스트 보러가기",d.createElement(i.I,{as:p.v,ml:2,w:5,h:5})))))}},92072:function(e,t,a){a.d(t,{Y:function(){return n}});const n=(0,a(37513).w)({d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z",displayName:"ChevronLeftIcon"})},12931:function(e,t,a){a.d(t,{v:function(){return n}});const n=(0,a(37513).w)({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"})},9e4:function(e,t,a){a.d(t,{E:function(){return i}});var n=a(74848),l=a(77341),r=a(5090),m=a(12600),s=a(53785);function c(e){return(0,l.bk)(e,(e=>"auto"===e?"auto":`span ${e}/span ${e}`))}const i=(0,m.R)((function(e,t){const{area:a,colSpan:l,colStart:m,colEnd:i,rowEnd:o,rowSpan:p,rowStart:E,...d}=e,h=(0,r.o)({gridArea:a,gridColumn:c(l),gridRow:c(p),gridColumnStart:m,gridColumnEnd:i,gridRowStart:E,gridRowEnd:o});return(0,n.jsx)(s.B.div,{ref:t,__css:h,...d})}));i.displayName="GridItem"},75828:function(e,t,a){a.d(t,{x:function(){return m}});var n=a(74848),l=a(12600),r=a(53785);const m=(0,l.R)((function(e,t){const{templateAreas:a,gap:l,rowGap:m,columnGap:s,column:c,row:i,autoFlow:o,autoRows:p,templateRows:E,autoColumns:d,templateColumns:h,...u}=e,g={display:"grid",gridTemplateAreas:a,gridGap:l,gridRowGap:m,gridColumnGap:s,gridAutoColumns:d,gridColumn:c,gridRow:i,gridAutoFlow:o,gridAutoRows:p,gridTemplateRows:E,gridTemplateColumns:h};return(0,n.jsx)(r.B.div,{ref:t,__css:g,...u})}));m.displayName="Grid"}}]);
//# sourceMappingURL=component---src-templates-post-page-tsx-content-file-path-users-jinsoo-git-jinsoolve-blog-content-ml-ml-textbook-7-untitled-mdx-6aa6ead9f9b92bdb967e.js.map