"use strict";(self.webpackChunkjinsoolve_blog=self.webpackChunkjinsoolve_blog||[]).push([[2984],{43026:function(e,t,a){a.r(t),a.d(t,{Head:function(){return S},default:function(){return A}});var n=a(28453),l=a(96540);function m(e){const t=Object.assign({p:"p",strong:"strong",h1:"h1",a:"a",span:"span",div:"div",math:"math",semantics:"semantics",mrow:"mrow",mi:"mi",mo:"mo",msub:"msub",mn:"mn",annotation:"annotation",h2:"h2",br:"br",img:"img",munder:"munder",ul:"ul",li:"li"},(0,n.RP)(),e.components),{Callout:a}=t;return a||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Callout",!0),l.createElement(l.Fragment,null,l.createElement(t.p,null,l.createElement(t.strong,null,"언어 모델"),"이란, 결국에는 ",l.createElement(t.strong,null,"그 다음으로 어떤 단어가 오는 것이 가장 자연스러운지를 확률로 보고 가장 높은 확률의 단어를 선택해서 문장을 구성"),"하는 방식이다."),"\n",l.createElement(t.p,null,"위 포스트에서는 n-gram 모델이 무엇이고 어떤 원리인지를 살펴볼 것이다."),"\n",l.createElement(t.h1,{id:"my-heading-1"},"n-gram 언어모델이란?",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-1"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,l.createElement(t.strong,null,"이전의 n-1개의 단어들을 살펴보고 그 다음 n번째로 어떤 단어가 올 확률이 가장 높은 지를 계산해서 문장을 구성하는 방식의 언어모델"),"이다."),"\n",l.createElement(t.div,{className:"math math-display"},l.createElement(t.span,{className:"katex-display"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"P"),l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.msub,null,l.createElement(t.mi,null,"w"),l.createElement(t.mi,null,"n")),l.createElement(t.mi,{mathvariant:"normal"},"∣"),l.createElement(t.msub,null,l.createElement(t.mi,null,"w"),l.createElement(t.mn,null,"1")),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.msub,null,l.createElement(t.mi,null,"w"),l.createElement(t.mn,null,"2")),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.mo,null,"…"),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.msub,null,l.createElement(t.mi,null,"w"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"n"),l.createElement(t.mo,null,"−"),l.createElement(t.mn,null,"1"))),l.createElement(t.mo,{stretchy:"false"},")"),l.createElement(t.mo,null,"≈"),l.createElement(t.mi,null,"P"),l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.msub,null,l.createElement(t.mi,null,"w"),l.createElement(t.mi,null,"n")),l.createElement(t.mi,{mathvariant:"normal"},"∣"),l.createElement(t.msub,null,l.createElement(t.mi,null,"w"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"n"),l.createElement(t.mo,null,"−"),l.createElement(t.mi,null,"N"),l.createElement(t.mo,null,"+"),l.createElement(t.mn,null,"1"))),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.mo,null,"…"),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.msub,null,l.createElement(t.mi,null,"w"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"n"),l.createElement(t.mo,null,"−"),l.createElement(t.mn,null,"1"))),l.createElement(t.mo,{stretchy:"false"},")")),l.createElement(t.annotation,{encoding:"application/x-tex"},"P(w_n | w_1, w_2, …, w_{n-1}) \\approx P(w_n | w_{n-N+1}, …, w_{n-1})")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),l.createElement(t.span,{className:"mopen"},"("),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.1514em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"n")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mord"},"∣"),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3011em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},"1")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3011em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},"2")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"minner"},"…"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3011em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"n"),l.createElement(t.span,{className:"mbin mtight"},"−"),l.createElement(t.span,{className:"mord mtight"},"1"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2083em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mclose"},")"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}}),l.createElement(t.span,{className:"mrel"},"≈"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}})),l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),l.createElement(t.span,{className:"mopen"},"("),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.1514em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"n")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mord"},"∣"),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3283em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"n"),l.createElement(t.span,{className:"mbin mtight"},"−"),l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"),l.createElement(t.span,{className:"mbin mtight"},"+"),l.createElement(t.span,{className:"mord mtight"},"1"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2083em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"minner"},"…"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3011em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"n"),l.createElement(t.span,{className:"mbin mtight"},"−"),l.createElement(t.span,{className:"mord mtight"},"1"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2083em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mclose"},")")))))),"\n",l.createElement(t.p,null,"모든 단어를 살펴보는 것이 아니라, 최근 n-1개의 단어를 보고 그 다음 n번째 단어를 추정하는 방식."),"\n",l.createElement(t.h1,{id:"my-heading-2"},"Sampling(샘플링)",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-2"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"샘플링이란, ",l.createElement(t.strong,null,"전체 데이터 집단에서 일부 데이터를 선택"),"하는 과정이다."),"\n",l.createElement(t.p,null,"위에서 n-gram 방식을 통해서 그 다음에 올 단어들의 확률을 구했다고 가정하자. 그럼 해당 단어들을 어떻게 샘플링 할 것인가에 대해서 얘기해보자."),"\n",l.createElement(t.h2,{id:"my-heading-3"},"Top-k",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-3"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"1 ~ k 등 까지의 단어들을 뽑는 샘플링"),"\n",l.createElement(t.h2,{id:"my-heading-4"},"Top-p",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-4"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"상위 누적확률 p 만큼까지의 단어들을 뽑는 샘플링"),"\n",l.createElement(t.h1,{id:"my-heading-5"},"Evaluating a language model",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-5"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,l.createElement(t.strong,null,"Extrinsic Evaluation"),"은 실제로 언어모델을 실제상황에 적용하여서 평가하는 방식이다.",l.createElement(t.br),"\n","그러나 이 방식은 비싸고 시간이 많이 걸린다.",l.createElement(t.br),"\n","따라서 우리는 모델을 평가하기 위해 주로 ",l.createElement(t.strong,null,"Intrinsic Evaluation"),"을 사용한다. Train과 Test Dataset을 나누어서 이를 적용해본다."),"\n",l.createElement(t.h2,{id:"my-heading-6"},"Perplexity(ppl)",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-6"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"사전적 의미로는 ",l.createElement(t.strong,null,"혼란도"),"라는 의미이다. 언어 모델의 평가지표 중 하나로써, 원하는 문장과 생성한 문장이 일치하지 않으면 혼란도는 높을 것이다. 쉽게 생각해보면, 모델의 손실함수와 동일한 의미를 갖는다고 볼 수 있다.",l.createElement(t.br),"\n",l.createElement(t.img,{src:"https://i.imgur.com/frP0S1z.png",alt:""}),l.createElement(t.br),"\n","위와 같이 Cross-entropy 형태로 나타낸다."),"\n",l.createElement(a,{type:"info"},l.createElement(t.p,null,"Cross-Entroy(교차 엔트로피)란, 두 개의 확률 분포 간의 차이를 측정하는 손실함수이다.",l.createElement(t.br),"\n","특히 분류 문제에서 모델의 예측이 정답과 얼마나 다른지를 평가하는 데 사용된다."),l.createElement(t.div,{className:"math math-display"},l.createElement(t.span,{className:"katex-display"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"H"),l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"P"),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.mi,null,"Q"),l.createElement(t.mo,{stretchy:"false"},")"),l.createElement(t.mo,null,"="),l.createElement(t.mo,null,"−"),l.createElement(t.munder,null,l.createElement(t.mo,null,"∑"),l.createElement(t.mi,null,"i")),l.createElement(t.mi,null,"P"),l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.msub,null,l.createElement(t.mi,null,"x"),l.createElement(t.mi,null,"i")),l.createElement(t.mo,{stretchy:"false"},")"),l.createElement(t.mi,null,"log"),l.createElement(t.mo,null,"⁡"),l.createElement(t.mi,null,"Q"),l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.msub,null,l.createElement(t.mi,null,"x"),l.createElement(t.mi,null,"i")),l.createElement(t.mo,{stretchy:"false"},")")),l.createElement(t.annotation,{encoding:"application/x-tex"},"H(P, Q) = - \\sum_{i} P(x_i) \\log Q(x_i)")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"}},"H"),l.createElement(t.span,{className:"mopen"},"("),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord mathnormal"},"Q"),l.createElement(t.span,{className:"mclose"},")"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}}),l.createElement(t.span,{className:"mrel"},"="),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}})),l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"2.3277em",verticalAlign:"-1.2777em"}}),l.createElement(t.span,{className:"mord"},"−"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mop op-limits"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"1.05em"}},l.createElement(t.span,{style:{top:"-1.8723em",marginLeft:"0em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3.05em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"i")))),l.createElement(t.span,{style:{top:"-3.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3.05em"}}),l.createElement(t.span,null,l.createElement(t.span,{className:"mop op-symbol large-op"},"∑")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"1.2777em"}},l.createElement(t.span))))),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),l.createElement(t.span,{className:"mopen"},"("),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal"},"x"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3117em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"i")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mclose"},")"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mop"},"lo",l.createElement(t.span,{style:{marginRight:"0.01389em"}},"g")),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord mathnormal"},"Q"),l.createElement(t.span,{className:"mopen"},"("),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal"},"x"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3117em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"i")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mclose"},")"))))))),"\n",l.createElement(t.p,null,"당연히 모델이 정확해질수록(혹은 훈련을 더 많이 할수록) ppl 수치는 낮아질 것이다."),"\n",l.createElement(t.h1,{id:"my-heading-7"},"Smoothing",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-7"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"Smoothing은 ",l.createElement(t.strong,null,"훈련데이터에 없는 단어나 구성이 등장했을 때, 확률을 0으로 두지 않게 하기 위해 적절한 값을 부여하는 기법"),"이다."),"\n",l.createElement(t.p,null,"확률을 0으로 설정해버리면, 해당 단어나 조합이 절대 발생하지 않는다고 판단하여 실제로 있는 말임에도 불구하고 언어모델이 해당 말을 생성하지 않는 문제가 발생한다. 이를 해결하기 위해 smoothing 기법을 사용한다."),"\n",l.createElement(t.p,null,"Smoothing을 하는 방식에도 여러 가지가 있다. 총 3가지 방식이 있다."),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"Additive: 약간의 값을 모든 확률에 더하는 방식"),"\n",l.createElement(t.li,null,"Interpolation: 몇 개의 n-gram들을 결합하는 방식"),"\n",l.createElement(t.li,null,"Discounting: 관측된 확률에서 약간의 양을 빼내서 새롭게 관측된 애들한테 나눠주는 방식"),"\n"),"\n",l.createElement(t.h2,{id:"my-heading-8"},"Laplace Smoothing (Additive)",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-8"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"확률에 특정 값을 균일하게 더해서 해결하는 방식이다. 흔히, Add-k(혹은 Add-alpha) 기법으로 알려져 있다.",l.createElement(t.br),"\n",l.createElement(t.img,{src:"https://i.imgur.com/qVSPqnZ.png",alt:""})),"\n",l.createElement(t.h2,{id:"my-heading-9"},"Linear Interpolation",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-9"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"여러 개의 n-gram의 확률 값을 가중 평균을 이용해서 합쳐서 최종 확률을 계산하는 방식이다.",l.createElement(t.br),"\n",l.createElement(t.img,{src:"https://i.imgur.com/mZNmTTC.png",alt:""})),"\n",l.createElement(t.p,null,"위 그림은 trigram, bigram, unigram의 확률 값을 가중평균을 이용해서 합친 것이다. 위와 같이 처리해주면 확률이 0이 되는 문제점을 해결할 수 있다."),"\n",l.createElement(t.p,null,"이때 가중평균의 ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"λ")),l.createElement(t.annotation,{encoding:"application/x-tex"},"\\lambda")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.6944em"}}),l.createElement(t.span,{className:"mord mathnormal"},"λ"))))),"값은 하이퍼 파리미터처럼 valid 데이터셋을 통해서 추정해내자."),"\n",l.createElement(t.h2,{id:"my-heading-10"},"Absolute Discounting",l.createElement(t.a,{"aria-hidden":"true",tabIndex:"-1",href:"#my-heading-10"},l.createElement(t.span,{className:"heading-anchor-icon"},"#"))),"\n",l.createElement(t.p,null,"Additive 기법과 반대의 느낌이다.",l.createElement(t.br),"\n","기존의 단어들과 구성들의 확률값에서 약간의 값을 뺀 후, 새로운 단어나 구성이 들어온다면 거기로 나눠줘서 해결하는 방식이다.",l.createElement(t.br),"\n",l.createElement(t.img,{src:"https://i.imgur.com/7zNdBpI.jpeg",alt:""})),"\n",l.createElement(t.p,null,"위 그림처럼 기존 확률값들에서 0.5씩 빼준 다음, 빼서 얻은 값을 새로운 단어나 구성이 들어온다면 거기로 나눠준다."))}var s=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,n.RP)(),e.components);return t?l.createElement(t,e,l.createElement(m,e)):m(e)};var r=a(54183),c=a(63840),i=a(67234),o=a(74196),p=a(33738),E=a(59146),d=a(32532),u=a(12931),g=a(92072),h=a(13626),N=a(39315),v=a(59879),y=a(68743),b=a(780),f=a(82228),x=a(66505),w=a(47722),R=a(55135),k=a(73992),z=a(80795);const C=e=>{var t,a,n,m,s,d;let{children:z,data:C,pageContext:S}=e;const A=C.otherLocalePost.nodes.map((e=>{var t;return(null===(t=e.frontmatter)||void 0===t?void 0:t.locale)||"ko"})),{0:L,1:I}=(0,l.useState)(!1),_=(0,l.useRef)(null),T=(null===(t=C.post)||void 0===t||null===(a=t.frontmatter)||void 0===a?void 0:a.locale)||"ko",P=null===(n=C.post)||void 0===n||null===(m=n.frontmatter)||void 0===m?void 0:m.slug,M=(0,r.A)({base:!1,"1.75xl":!0}),{0:j,1:D}=((0,r.A)({base:"6",md:"8"}),(0,l.useState)(!1)),W=(0,l.useRef)(null),{0:O,1:H}=(0,l.useState)(300),{colorMode:G}=(0,c.G6)();return(0,l.useEffect)((()=>{const e=()=>{I(window.innerWidth<630)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,l.useEffect)((()=>{const e=e=>{(W.current&&!W.current.contains(e.target)||_.current&&!_.current.contains(e.target))&&D(!1)};return j&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[j]),(0,l.useEffect)((()=>{const e=e=>{if(!W.current)return;const t=W.current;if(t.contains(e.target)){const a=0===t.scrollTop,n=Math.ceil(t.scrollTop+t.clientHeight)>=t.scrollHeight;(a&&e.deltaY<0||n&&e.deltaY>0)&&e.preventDefault()}},t=e=>{if(!W.current)return;const t=W.current;if(t.contains(e.target)){const a=0===t.scrollTop,n=Math.ceil(t.scrollTop+t.clientHeight)>=t.scrollHeight;(a&&e.touches[0].clientY>0||n&&e.touches[0].clientY<0)&&e.preventDefault()}};return j&&(document.addEventListener("wheel",e,{passive:!1}),document.addEventListener("touchmove",t,{passive:!1})),()=>{document.removeEventListener("wheel",e),document.removeEventListener("touchmove",t)}}),[j]),l.createElement(x.A,{tableOfContents:M?null===(s=C.post)||void 0===s?void 0:s.myTableOfContents:void 0},l.createElement(i.s,{direction:"column",width:"100%"},l.createElement(f.A,{readingTime:S.readingTime.text,post:C.post}),!M&&(null===(d=C.post)||void 0===d?void 0:d.myTableOfContents)&&l.createElement(l.Fragment,null,l.createElement(N.P.div,{initial:{right:"0px"},animate:{right:"0px"},transition:{duration:.3},style:{position:"fixed",bottom:L?"40px":"70px",transform:"translateY(-50%)",zIndex:10}},l.createElement(o.K,{"aria-label":"Toggle TOC",borderRadius:"full",size:"lg",right:{base:"12px",sm:"15px",md:"30px"},onClick:()=>D(!j),variant:"ghost",_hover:{bg:"transparent",color:"blue.400"},_focus:{boxShadow:"none",bg:"transparent"},display:j?"none":"block",icon:l.createElement(i.s,{alignItems:"center",justifyContent:"center"},j?l.createElement(l.Fragment,null,l.createElement(u.v,{boxSize:"20px",ml:-1}),l.createElement(p.I,{as:v.hCN,boxSize:"24px",ml:-1})," "):l.createElement(l.Fragment,null,l.createElement(g.Y,{boxSize:"20px",ml:-1}),l.createElement(p.I,{as:v.hCN,boxSize:"24px",ml:-1})," "))})),l.createElement(N.P.div,{initial:{right:"-300px"},animate:{right:j?"0px":"-300px"},transition:{duration:.3},ref:W,style:{position:"fixed",top:0,height:"100vh",width:"300px",maxWidth:"80vw",zIndex:10,overflowY:"auto",overflowX:"hidden"}},l.createElement(E.a,{backgroundColor:"white",boxShadow:"md",position:"relative",height:"100%",width:"300px",_dark:{backgroundColor:"gray.800"}},l.createElement(o.K,{"aria-label":"Close TOC",icon:l.createElement(h.U,null),position:"absolute",top:"10px",right:"10px",onClick:()=>D(!1),size:"sm",backgroundColor:"transparent",color:"black",_dark:{color:"white"}}),l.createElement(E.a,{pt:"60px",pb:"20px",pl:"20px",width:"300px",backgroundColor:"white",_dark:{backgroundColor:"gray.800"}},l.createElement(k.A,{tableOfContents:C.post.myTableOfContents}))))),A.length>1&&l.createElement(b.A,{currentSlug:P,locales:A,currentLocale:T}),l.createElement(E.a,{marginTop:"40px",sx:{img:{borderRadius:"10px"}}},z),l.createElement(R.A,{relatedPosts:C.relatedPosts}),l.createElement(w.A,null),l.createElement(y.A,null)))},S=e=>{var t,a,n,m,s,r,c,i,o,p,E,u,g,h,N,v,y,b,f,x,w;let{data:R}=e;const k=(null===(t=R.post)||void 0===t||null===(a=t.frontmatter)||void 0===a?void 0:a.locale)||"ko",C="ko"===k?(null===(n=R.post)||void 0===n||null===(m=n.frontmatter)||void 0===m?void 0:m.title)+" - Jinsoolve 블로그":(null===(s=R.post)||void 0===s||null===(r=s.frontmatter)||void 0===r?void 0:r.title)+" - Jinsoolve Blog",S=null===(c=R.post)||void 0===c||null===(i=c.frontmatter)||void 0===i?void 0:i.description,A=null===(o=R.post)||void 0===o||null===(p=o.frontmatter)||void 0===p||null===(E=p.thumbnail)||void 0===E||null===(u=E.childImageSharp)||void 0===u?void 0:u.gatsbyImageData,L="ko"===k?"ko_KR":"en_US",I="ko"===k?"개발":"Development";return l.createElement(l.Fragment,null,l.createElement("title",null,C),l.createElement("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),l.createElement("meta",{property:"og:url",content:z.V2+"/posts/"+(null===(g=R.post)||void 0===g||null===(h=g.frontmatter)||void 0===h?void 0:h.slug)}),l.createElement("meta",{property:"og:type",content:"website"}),l.createElement("meta",{property:"og:site_name",content:C}),l.createElement("meta",{property:"og:title",content:C}),l.createElement("meta",{property:"og:description",content:S}),l.createElement("meta",{property:"og:image",content:(0,d.d)(A)}),l.createElement("meta",{property:"og:locale",content:L}),l.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),l.createElement("meta",{property:"twitter:domain",content:"jinsoolve.netlify.app"}),l.createElement("meta",{property:"twitter:url",content:z.V2+"/posts/"+(null===(N=R.post)||void 0===N||null===(v=N.frontmatter)||void 0===v?void 0:v.slug)}),l.createElement("meta",{name:"twitter:title",content:C}),l.createElement("meta",{name:"twitter:description",content:S}),l.createElement("meta",{name:"twitter:image",content:(0,d.d)(A)}),l.createElement("meta",{name:"twitter:label1",content:"Category"}),l.createElement("meta",{name:"twitter:data1",content:I+" | "+(null===(y=R.post)||void 0===y||null===(b=y.frontmatter)||void 0===b?void 0:b.categories[0])}),l.createElement("meta",{name:"article:published_time",content:(null===(f=R.post)||void 0===f||null===(x=f.frontmatter)||void 0===x||null===(w=x.createdAt)||void 0===w?void 0:w.replace(/[/]/g,"-"))+"T09:00:00.000Z"}))};function A(e){return l.createElement(C,e,l.createElement(s,e))}},780:function(e,t,a){var n=a(67234),l=a(21052),m=a(58693),s=a(96540);t.A=e=>{let{currentLocale:t,locales:a,currentSlug:r}=e;return s.createElement(n.s,{alignItems:"center",marginTop:10,gap:2},s.createElement(l.E,{fontSize:16,fontWeight:"800",color:"black.900"},"Locales:"),s.createElement(n.s,{overflow:"hidden",width:"100%",gap:2,fontSize:12},a.map((e=>{const a="ko"===e?"/posts/"+r:"/"+e+"/posts/"+r;return e===t?s.createElement(l.E,{key:e,fontSize:16,fontWeight:"600",textDecoration:"underline",color:"black.900"},e):s.createElement(m.Link,{key:e,to:a},s.createElement(l.E,{fontSize:16,color:"black.900"},e))}))))}},95841:function(e,t,a){var n=a(59146),l=a(67234),m=a(85353),s=a(21052),r=a(58693),c=a(32532),i=a(96540),o=a(63840),p=a(96540);t.A=e=>{let{createdAt:t,description:a,slug:E,thumbnail:d,title:u,updatedAt:g,excerpt:h}=e;const N=(0,i.useMemo)((()=>(new Date).getTime()-new Date(t).getTime()),[t]),v=(0,i.useMemo)((()=>Math.floor(N/864e5)<=10),[N]),y=(0,o.dU)("gray.50","#444548"),b=(0,o.dU)("blue.500","blue.400"),f=((0,o.dU)("0 4px 6px rgba(0, 0, 0, 0.3)","0 4px 6px rgba(255, 255, 255, 0.3)"),(0,i.useMemo)((()=>d?"380px":{base:"190px",sm_md:"380px"}),[d]));return p.createElement(r.Link,{to:"/posts/"+E},p.createElement(n.a,{as:"article",transition:"all 0.25s ease",position:"relative",borderRadius:"20px",overflow:"hidden",width:{base:"280px",sm_md:"290px"},minWidth:"205px",maxWidth:"85vw",minHeight:f,height:"100%",boxShadow:"xl",borderWidth:"2px",borderColor:y,_hover:{borderColor:b,boxShadow:"xl",cursor:"pointer"}},p.createElement(c.G,{objectFit:"cover",style:{maxHeight:"171px",height:"45%",width:"100%"},image:d,alt:E+" cover image"}),p.createElement(l.s,{flexDirection:"column",justifyContent:"space-between",height:d?"55%":"100%",padding:"20px"},p.createElement(n.a,null,p.createElement(m.D,{fontSize:"20px",fontWeight:"700",marginBottom:"8px"},u),p.createElement(s.E,{fontSize:"16px",color:"gray.600",noOfLines:2,marginBottom:"10px"},a||h)),p.createElement(l.s,{justifyContent:"space-between",alignItems:"flex-start",marginTop:"10px"},p.createElement(s.E,{fontSize:"14px",color:"gray.500"},g?g+" (updated)":t),p.createElement(n.a,{backgroundColor:"blue.400",color:"white",borderRadius:"12px",padding:"4px 8px",fontSize:"12px",fontWeight:"bold",visibility:v?"visible":"hidden"},"NEW POST")))))}},55135:function(e,t,a){var n=a(63840),l=a(59146),m=a(85353),s=a(32818),r=a(75828),c=a(9e4),i=a(33738),o=a(58693),p=a(12931),E=a(95841),d=a(96540);t.A=e=>{let{relatedPosts:t}=e;const a=null==t?void 0:t.nodes.length,u=null==t?void 0:t.nodes.slice(0,4),g=((0,n.dU)("white","black"),(0,n.dU)("gray.50","#444548")),h=(0,n.dU)("blue.500","blue.400");return d.createElement(l.a,{marginTop:"200px"},a?d.createElement(m.D,{as:"h2",fontSize:24},"관련 포스트가 ",a,"개 있어요."):d.createElement(s.o,{height:"100px",borderRadius:"8px",backgroundColor:"blue.50"},d.createElement("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M12 1.999c5.524 0 10.002 4.478 10.002 10.002 0 5.523-4.478 10.001-10.002 10.001-5.524 0-10.002-4.478-10.002-10.001C1.998 6.477 6.476 1.999 12 1.999Zm-.004 8.25a1 1 0 0 0-.992.885l-.007.116.003 5.502.007.117a1 1 0 0 0 1.987-.002L13 16.75l-.003-5.501-.007-.117a1 1 0 0 0-.994-.882ZM12 6.5a1.251 1.251 0 1 0 0 2.503A1.251 1.251 0 0 0 12 6.5Z",fill:"#3182ce"})),d.createElement(m.D,{as:"h2",color:"blue.500",fontSize:20},"관련 포스트가 없어요.")),d.createElement(r.x,{mt:"20px",templateColumns:{sm_md:"repeat(2, 1fr)",lg:"repeat(2, 1fr)"},gap:6,alignItems:"center",justifyContent:"center"},null==u?void 0:u.map((e=>{var t,a,n,l,m,s,r,i,o,p;return d.createElement(c.E,{as:"article",key:null==e||null===(t=e.frontmatter)||void 0===t?void 0:t.slug,display:"flex",alignItems:"center",justifyContent:"center"},d.createElement(E.A,{title:null===(a=e.frontmatter)||void 0===a?void 0:a.title,description:null===(n=e.frontmatter)||void 0===n?void 0:n.description,slug:null===(l=e.frontmatter)||void 0===l?void 0:l.slug,thumbnail:null===(m=e.frontmatter)||void 0===m||null===(s=m.thumbnail)||void 0===s||null===(r=s.childImageSharp)||void 0===r?void 0:r.gatsbyImageData,createdAt:null===(i=e.frontmatter)||void 0===i?void 0:i.createdAt,updatedAt:null===(o=e.frontmatter)||void 0===o?void 0:o.updatedAt,categories:null===(p=e.frontmatter)||void 0===p?void 0:p.categories,excerpt:e.excerpt}))}))),a>6&&d.createElement(s.o,{mt:"20px"},d.createElement(o.Link,{to:"/categories/"+t.nodes[0].frontmatter.categories[0]},d.createElement(l.a,{as:"button",mt:"20px",transition:"all 0.25s ease",padding:"10px 20px",borderRadius:"12px",fontWeight:"bold",boxShadow:"xl",borderWidth:"2px",borderColor:g,_hover:{borderColor:h,boxShadow:"xl",cursor:"pointer"},display:"flex",alignItems:"center"},"더 많은 관련 포스트 보러가기",d.createElement(i.I,{as:p.v,ml:2,w:5,h:5})))))}},92072:function(e,t,a){a.d(t,{Y:function(){return n}});const n=(0,a(37513).w)({d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z",displayName:"ChevronLeftIcon"})},12931:function(e,t,a){a.d(t,{v:function(){return n}});const n=(0,a(37513).w)({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"})},9e4:function(e,t,a){a.d(t,{E:function(){return i}});var n=a(74848),l=a(77341),m=a(5090),s=a(12600),r=a(53785);function c(e){return(0,l.bk)(e,(e=>"auto"===e?"auto":`span ${e}/span ${e}`))}const i=(0,s.R)((function(e,t){const{area:a,colSpan:l,colStart:s,colEnd:i,rowEnd:o,rowSpan:p,rowStart:E,...d}=e,u=(0,m.o)({gridArea:a,gridColumn:c(l),gridRow:c(p),gridColumnStart:s,gridColumnEnd:i,gridRowStart:E,gridRowEnd:o});return(0,n.jsx)(r.B.div,{ref:t,__css:u,...d})}));i.displayName="GridItem"},75828:function(e,t,a){a.d(t,{x:function(){return s}});var n=a(74848),l=a(12600),m=a(53785);const s=(0,l.R)((function(e,t){const{templateAreas:a,gap:l,rowGap:s,columnGap:r,column:c,row:i,autoFlow:o,autoRows:p,templateRows:E,autoColumns:d,templateColumns:u,...g}=e,h={display:"grid",gridTemplateAreas:a,gridGap:l,gridRowGap:s,gridColumnGap:r,gridAutoColumns:d,gridColumn:c,gridRow:i,gridAutoFlow:o,gridAutoRows:p,gridTemplateRows:E,gridTemplateColumns:u};return(0,n.jsx)(m.B.div,{ref:t,__css:h,...g})}));s.displayName="Grid"}}]);
//# sourceMappingURL=component---src-templates-post-page-tsx-content-file-path-users-jinsoo-git-jinsoolve-blog-content-ml-intro-to-nlp-2-untitled-md-a891be924bf8750d4477.js.map